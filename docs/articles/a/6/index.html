<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        Document
    </title>
    <link rel='stylesheet' href=../../../css/index.css />
    <link rel='stylesheet' href=../../../css/bnf.css /><link rel='stylesheet' href=../../../css/c.css /><link rel='stylesheet' href=../../../css/json.css /><link rel='stylesheet' href=../../../css/lua.css /><link rel='stylesheet' href=../../../css/python.css /><link rel='stylesheet' href=../../../css/shell.css /><link rel='stylesheet' href=../../../css/toml.css /><link rel='stylesheet' href=../../../css/txt.css /><link rel='stylesheet' href=../../../css/xml.css /><link rel='stylesheet' href=../../../css/yaml.css />
    <link rel="icon" href="https://raw.githubusercontent.com/learner-lu/picbed/master/logo.png">
</head>

<body class="light">
    <a href="https://github.com/luzhixing12345/zood" target="_blank" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <div class="header-navigator"><ul><li><a href="#h1-0">BombLab</a><ul><li><a href="#h2-1">基本知识</a><ul><li><a href="#h3-2">x86-64架构调用函数时参数传递使用的寄存器和栈地址</a></li></ul><ul><li><a href="#h3-3">x86-64寄存器</a></li></ul><ul><li><a href="#h3-4">操作数指示符</a></li></ul><ul><li><a href="#h3-5">常用汇编</a></li></ul></li></ul><ul><li><a href="#h2-6">GDB</a><ul><li><a href="#h3-7">调试使用到的指令</a></li></ul></li></ul><ul><li><a href="#h2-8">开始之前</a></li></ul><ul><li><a href="#h2-9">实验报告</a><ul><li><a href="#h3-10">phase_1</a></li></ul><ul><li><a href="#h3-11">phase_2</a></li></ul><ul><li><a href="#h3-12">phase_3</a></li></ul><ul><li><a href="#h3-13">phase_4</a></li></ul><ul><li><a href="#h3-14">phase_5</a></li></ul><ul><li><a href="#h3-15">phase_6</a></li></ul><ul><li><a href="#h3-16">secret_phase</a></li></ul></li></ul></li></ul></div><div class='markdown-body'><h1 id="h1-0">BombLab</h1><p><a href="../../API\zood -g" target="_self">zood -g</a></p><blockquote><p><a href="https://earthaa.github.io/2020/01/12/CSAPP-Bomblab/" target="_blank">&lt;深入理解计算机系统&gt;Bomb Lab实验解析</a></p><p><a href="https://hakula.xyz/posts/note/csapp/bomb-lab/" target="_blank">CS:APP - Bomb Lab</a></p></blockquote><p>如果在gdb调试的出现Permission deny的问题可以调整bomb的权限</p><pre class="language-shell"><code><span class="Token Program ID">chmod</span><span class="Token SPACE"> </span><span class="Token NUMBER">777</span><span class="Token SPACE"> </span><span class="Token ID">bomb</span></code></pre><h2 id="h2-1">基本知识</h2><p>Bomb lab 主要考察对应汇编代码的阅读和理解能力,以及使用gdb调试工具</p><h3 id="h3-2">x86-64架构调用函数时参数传递使用的寄存器和栈地址</h3><table><tr><th>%rdi</th><th>%rsi</th><th>%rdx</th><th>%rcx</th><th>%r8</th><th>%r9</th><th>(%rsp)</th><th>(%rsp+8)</th><th>(%rsp+...)</th></tr></table><p>return -&gt; %rax</p><h3 id="h3-3">x86-64寄存器</h3><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/QQ%E5%9B%BE%E7%89%8720221015171443.jpg"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/QQ%E5%9B%BE%E7%89%8720221015171443.jpg" alt="QQ图片20221015171443"></a></p><h3 id="h3-4">操作数指示符</h3><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/as123gsz.jpg"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/as123gsz.jpg" alt="as123gsz"></a></p><h3 id="h3-5">常用汇编</h3><ul><li>mov S,D : 把S的值传给D,具体的S见 操作数指示符</li></ul><ul><li>lea A,B : 计算A表达式的值传给B</li></ul><ul><li>cmp A,B : 对 B-A 的值进行判断, gl(有符号) ab(无符号)</li></ul><ul><li>test A,B : A&amp;B</li></ul><ul><li>je : 等于0跳转</li></ul><ul><li>jne : 不等于0跳转</li></ul><h2 id="h2-6">GDB</h2><h3 id="h3-7">调试使用到的指令</h3><blockquote><p>注 : 括号表示完成指令名中可以被省略的部分</p></blockquote><table><tr><th>命令</th><th>用途</th></tr><tr><td style="text-align:center">                gdb bomb</td><td style="text-align:center">                使用gdb调试可执行文件bomb</td></tr><tr><td style="text-align:center">                disas(semble) phase_1</td><td style="text-align:center">                反汇编函数phase_1</td></tr><tr><td style="text-align:center">                disas 0x402400</td><td style="text-align:center">                反汇编地址0x402400附近的函数</td></tr><tr><td style="text-align:center">                x/s 0x400544</td><td style="text-align:center">                以字符串的形式输出,字符串在内存中的首地址为0x400544</td></tr><tr><td style="text-align:center">                x/d 0x400544</td><td style="text-align:center">                以整数的形式输出,整数在内存中的首地址为0x400544</td></tr><tr><td style="text-align:center">                x/x 0x400544</td><td style="text-align:center">                以16进制的形式输出</td></tr><tr><td style="text-align:center">                x/4x 0x400544</td><td style="text-align:center">                以16进制的形式输出四个字节的数据</td></tr><tr><td style="text-align:center">                x/a 0x400544</td><td style="text-align:center">                以指针的形式</td></tr><tr><td style="text-align:center">                b(reak) *0x400da4</td><td style="text-align:center">                在0x400da4地址处打断点</td></tr><tr><td style="text-align:center">                b phase_5</td><td style="text-align:center">                在phase_5函数入口地址打断点</td></tr><tr><td style="text-align:center">                b 74</td><td style="text-align:center">                在源代码74行打断点</td></tr><tr><td style="text-align:center">                r(un)</td><td style="text-align:center">                运行可执行文件</td></tr><tr><td style="text-align:center">                r input.txt</td><td style="text-align:center">                运行可执行文件,传入一个参数,参数名是input.txt</td></tr><tr><td style="text-align:center">                c(ontinue)</td><td style="text-align:center">                从断点处继续运行</td></tr><tr><td style="text-align:center">                k(ill)</td><td style="text-align:center">                停止调试当前运行的程序</td></tr><tr><td style="text-align:center">                q(uit)</td><td style="text-align:center">                退出调试</td></tr><tr><td style="text-align:center">                i(nfo) r(egister)</td><td style="text-align:center">                打印所有整数寄存器及其内容</td></tr><tr><td style="text-align:center">                i r rax</td><td style="text-align:center">                打印rax寄存器及其内容</td></tr><tr><td style="text-align:center">                i b</td><td style="text-align:center">                打印所有断点</td></tr><tr><td style="text-align:center">                d(elete) 1</td><td style="text-align:center">                删除断点1</td></tr></table><blockquote><p><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/gdb.html" target="_blank">gdb 调试利器</a></p><p><a href="https://darkdust.net/files/GDB%20Cheat%20Sheet.pdf" target="_blank">gdb文档</a></p></blockquote><h2 id="h2-8">开始之前</h2><p>解压文件之后可以看到三个文件 <code>bomb</code> 是本次实验使用的可执行文件, <code>bomb.c</code> 是源代码中的主函数部分, <code>README</code>是介绍文件</p><p>浏览 <code>bomb.c</code> 可以看到它在开头引用了</p><pre class="language-c"><code><span class="Token HASH">#</span><span class="Token Keyword Preprocess ControlLine INCLUDE">include</span><span class="Token Keyword Preprocess ControlLine SPACE"> </span><span class="Token String HeaderName STRING">&quot;support.h&quot;</span><span class="Token LF">
</span><span class="Token HASH">#</span><span class="Token Keyword Preprocess ControlLine INCLUDE">include</span><span class="Token Keyword Preprocess ControlLine SPACE"> </span><span class="Token String HeaderName STRING">&quot;phases.h&quot;</span></code></pre><p>所以可以看出 <code>bomb.c</code> 只是源文件的一部分, <code>bomb</code> 是由多个文件一起编译得到的,提供 bomb.c 文件实际上是为了给读者一个清晰的bomb lab思路</p><p>使用 <code>gdb bomb</code> 进入调试</p><h2 id="h2-9">实验报告</h2><h3 id="h3-10">phase_1</h3><p>使用 <code>disas phase_1</code> 查看第一关汇编</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000400ee0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ee4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x402400</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">esi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402400</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ee9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">9</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x401338</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">strings_not_equal</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">比较</span><span class="Token SPACE"> </span><span class="Token ID">edi</span><span class="Token SPACE"> </span><span class="Token ID">esi</span><span class="Token SPACE"> </span><span class="Token ID">两个字符串是否相同</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400eee</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">14</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">test</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">相同返回0</span><span class="Token COMMA">,</span><span class="Token ID">不相同返回1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ef0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">16</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x400ef7</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_1</span><span class="Token PLUS">+</span><span class="Token NUMBER">23</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">        </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">应该相同</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ef2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">18</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ef7</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">23</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400efb</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">ret</span></code></pre><p>前一步使用 <code>read_line</code> 读取了一行输入,输入被读入了</p><p>edi指向用户输入的字符串的首地址, <code>strings_not_equal</code> 函数的作用是判断两个字符串是否不相同,不相同返回1,相同返回0</p><blockquote><p>如果有耐心阅读可以稍微解释一下strings_not_equal的汇编细节,也可以省略</p></blockquote><p>0x402400指向的字符串通过 <code>x/s 0x402400</code> 查看是 <code>&quot;Border relations with Canada have never been better.&quot;</code></p><p>所以第一关的答案是</p><pre class="language-txt"><code><span class="Token ID">Border</span><span class="Token SPACE"> </span><span class="Token ID">relations</span><span class="Token SPACE"> </span><span class="Token ID">with</span><span class="Token SPACE"> </span><span class="Token ID">Canada</span><span class="Token SPACE"> </span><span class="Token ID">have</span><span class="Token SPACE"> </span><span class="Token ID">never</span><span class="Token SPACE"> </span><span class="Token ID">been</span><span class="Token SPACE"> </span><span class="Token ID">better</span><span class="Token DOT">.</span></code></pre><h3 id="h3-11">phase_2</h3><p><code>disas phase_2</code> ,先看第一部分</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000400efc</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">push</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">rbp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400efd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">push</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400efe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">2</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x28</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f02</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">6</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token SPACE">                    </span><span class="Token HASH">#</span><span class="Token ID">rsi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f05</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">9</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40145c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">read_six_numbers</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>查看 <code>read_six_numbers</code> 函数反汇编</p><pre class="language-txt"><code><span class="Token NUMBER">0x000000000040145c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401460</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token SPACE">                        </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rdx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401463</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">7</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x4</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token SPACE">                   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rcx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">4</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401467</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">11</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x14</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">20</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040146b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">15</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">                   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">8</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">20</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401470</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">20</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">16</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401474</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">16</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401478</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">28</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0xc</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r9</span><span class="Token SPACE">                    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">r9</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsi</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">12</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040147c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r8</span><span class="Token SPACE">                    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">r8</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsi</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">8</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401480</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">36</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x4025c3</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">                   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">esi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x4025c3</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401485</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                        </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040148a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">46</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x400bf0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token UNDERLINE">_</span><span class="Token UNDERLINE">_</span><span class="Token ID">isoc99_sscanf</span><span class="Token AT_SIGN">@</span><span class="Token ID">plt</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">调用sccanf函数</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040148f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">51</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x5</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                        </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">返回值应该大于5</span><span class="Token COMMA">,</span><span class="Token ID">即至少读取六个</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401492</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">54</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jg</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x401499</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">read_six_numbers</span><span class="Token PLUS">+</span><span class="Token NUMBER">61</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401494</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">56</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401499</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">61</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040149d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">65</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">ret</span></code></pre><p><code>sccanf</code> 的作用是从字符串中提取得到格式化的值</p><p>查看 <code>0x4025c3</code> 的字符串为 <code>&quot;%d %d %d %d %d %d&quot;</code>,即接收六个整数(int),所以输入应该为空格分隔的六个整数</p><ul><li>rdi = 用户输入字符串的首地址</li></ul><ul><li>rsi = 0x4025c3(读取的格式,六个整数)</li></ul><ul><li>rdx = rsp</li></ul><ul><li>rcx = rsp+4</li></ul><ul><li>r8 = rsp+8</li></ul><ul><li>r9 = rsp+12</li></ul><ul><li>(rsp) = rsp+16</li></ul><ul><li>(rsp+8) = rsp+20</li></ul><p>根据x86-64架构调用函数时参数传递使用的寄存器和栈地址的规则</p><pre class="language-txt"><code><span class="Token DIV">/</span><span class="Token DIV">/</span><span class="Token SPACE"> </span><span class="Token ID">假设输入是</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token SPACE"> </span><span class="Token NUMBER">3</span><span class="Token SPACE"> </span><span class="Token NUMBER">4</span><span class="Token SPACE"> </span><span class="Token NUMBER">5</span><span class="Token SPACE"> </span><span class="Token NUMBER">6</span><span class="Token SPACE"> </span><span class="Token POINT">-&gt;</span><span class="Token SPACE"> </span><span class="Token ID">字符串</span><span class="Token LF">
</span><span class="Token ID">int</span><span class="Token SPACE"> </span><span class="Token ID">sccanf</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token QUOTO">&quot;</span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token SPACE"> </span><span class="Token NUMBER">3</span><span class="Token SPACE"> </span><span class="Token NUMBER">4</span><span class="Token SPACE"> </span><span class="Token NUMBER">5</span><span class="Token SPACE"> </span><span class="Token NUMBER">6</span><span class="Token QUOTO">&quot;</span><span class="Token COMMA">,</span><span class="Token QUOTO">&quot;</span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token QUOTO">&quot;</span><span class="Token COMMA">,</span><span class="Token ID">rdx</span><span class="Token COMMA">,</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token ID">r8</span><span class="Token COMMA">,</span><span class="Token ID">r9</span><span class="Token COMMA">,</span><span class="Token BraceDepth-1 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token BraceDepth-1 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token BraceDepth-1 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">8</span><span class="Token BraceDepth-1 RPAREN">)</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token POINT">-&gt;</span><span class="Token SPACE"> </span><span class="Token ID">rax</span></code></pre><p>所以通过 <code>sscanf</code> 从字符串中读取的六个整数分别存放在(rsp),(rsp+4),...等连续六个位置</p><p>再看第二部分,</p><pre class="language-txt"><code><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f0a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">14</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmpl</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">             </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">第一个输入的整数</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">number</span><span class="Token BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">应该为</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f0e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">18</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x400f30</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_2</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f10</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">20</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f15</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">25</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400f30</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_2</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f17</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MINUS">-</span><span class="Token NUMBER">0x4</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">         </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rbx</span><span class="Token MINUS">-</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ASSIGN">=</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ASSIGN">=</span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f1a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">30</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token MUL">*</span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f1c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">             </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rbx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token ID">即</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ASSIGN">=</span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token ASSIGN">=</span><span class="Token ID">eax</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">2</span><span class="Token MUL">*</span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f1e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">34</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x400f25</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_2</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f20</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">36</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f25</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x4</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rbx</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">4</span><span class="Token COMMA">,</span><span class="Token ID">开始循环</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f29</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">45</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rbp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">判断是否越界</span><span class="Token COMMA">,</span><span class="Token ID">越界则结束</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f2c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">48</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400f17</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_2</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f2e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">50</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400f3c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_2</span><span class="Token PLUS">+</span><span class="Token NUMBER">64</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f30</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x4</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rbx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">number</span><span class="Token BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f35</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x18</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbp</span><span class="Token SPACE">         </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rbp</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">0x18</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">0x18</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">24</span><span class="Token COMMA">,</span><span class="Token ID">相当于数组的边界number</span><span class="Token BraceDepth-1 LSQUAR_PAREN">[</span><span class="Token NUMBER">6</span><span class="Token BraceDepth-1 RSQUAR_PAREN">]</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f3a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">62</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400f17</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_2</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f3c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">64</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x28</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f40</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">68</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">pop</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f41</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">69</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">pop</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rbp</span><span class="Token LF">
</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x0000000000400f42</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">70</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">ret</span></code></pre><p>阅读汇编,可知第一个输入的(rsp),也就是number[0]应该为1,之后的数字应该依次乘2,也就是一个首项为1,公比为2的等比数列,一共六个输入,所以答案为</p><pre class="language-txt"><code><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token SPACE"> </span><span class="Token NUMBER">4</span><span class="Token SPACE"> </span><span class="Token NUMBER">8</span><span class="Token SPACE"> </span><span class="Token NUMBER">16</span><span class="Token SPACE"> </span><span class="Token NUMBER">32</span></code></pre><h3 id="h3-12">phase_3</h3><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000400f43</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f47</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0xc</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f4c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">9</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f51</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">14</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x4025cf</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f56</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">19</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f5b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x400bf0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token UNDERLINE">_</span><span class="Token UNDERLINE">_</span><span class="Token ID">isoc99_sscanf</span><span class="Token AT_SIGN">@</span><span class="Token ID">plt</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>查看 <code>x/s 0x4025cf</code> 得到 &quot;%d %d&quot;,所以输入应该为空格分隔的两个整数</p><p>第一个值保存在rdx,也就是(rsp+8),第二个值保存在(rsp+12)</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000400f60</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">29</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">获取的值应该大于1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f63</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jg</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x400f6a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">39</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f65</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">34</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f6a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">39</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmpl</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x7</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">第一个值应该小于等于7</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f6f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">44</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">ja</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x400fad</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">106</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f71</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">46</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f75</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">50</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token MUL">*</span><span class="Token NUMBER">0x402470</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">8</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">跳转到0x402470</span><span class="Token PLUS">+</span><span class="Token NUMBER">8</span><span class="Token MUL">*</span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token ID">的位置</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f7c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xcf</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f81</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">62</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f83</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">64</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x2c3</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f88</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">69</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f8a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">71</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x100</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f8f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">76</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f91</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">78</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x185</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f96</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">83</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f98</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">85</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xce</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f9d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">90</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400f9f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">92</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x2aa</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fa4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">97</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fa6</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">99</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x147</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fab</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">104</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fad</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">106</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fb2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">111</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fb7</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">116</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fb9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">118</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x137</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fbe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0xc</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token ID">应该等于eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fc2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">127</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x400fc9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">134</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fc4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">129</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fc9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">134</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fcd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">138</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">ret</span></code></pre><p>这里 <code>&lt;+50&gt;:jmp *0x402470(,%rax,8)</code> 显然是一个跳转的地址,既然已经知道number[0]的值小于等于7,这里显然应该&gt;=0,所以我们可以使用 <code>x/a + 地址</code> 依次查看从 <code>0x402470</code> 的跳转位置,得到的结果如下</p><pre class="language-txt"><code><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402470</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token LF">
</span><span class="Token NUMBER">0x402470</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400f7c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402478</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x402478</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400fb9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">118</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402480</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token LF">
</span><span class="Token NUMBER">0x402480</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400f83</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">64</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402488</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">3</span><span class="Token LF">
</span><span class="Token NUMBER">0x402488</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400f8a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">71</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402490</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">4</span><span class="Token LF">
</span><span class="Token NUMBER">0x402490</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400f91</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">78</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x402498</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">5</span><span class="Token LF">
</span><span class="Token NUMBER">0x402498</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400f98</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">85</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x4024a0</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">6</span><span class="Token LF">
</span><span class="Token NUMBER">0x4024a0</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400f9f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">92</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x4024a8</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">对应number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">7</span><span class="Token LF">
</span><span class="Token NUMBER">0x4024a8</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x400fa6</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_3</span><span class="Token PLUS">+</span><span class="Token NUMBER">99</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>那么根据第一个输入可以得到不同的跳转地址,接下来只需要根据跳转的位置后面跟的 mov指令就可以得到number[1]的值了</p><p>所以第三关的答案不唯一,以下任何一组答案都可以通过</p><pre class="language-txt"><code><span class="Token NUMBER">0</span><span class="Token SPACE"> </span><span class="Token NUMBER">207</span><span class="Token LF">
</span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token NUMBER">331</span><span class="Token LF">
</span><span class="Token NUMBER">2</span><span class="Token SPACE"> </span><span class="Token NUMBER">707</span><span class="Token LF">
</span><span class="Token NUMBER">3</span><span class="Token SPACE"> </span><span class="Token NUMBER">256</span><span class="Token LF">
</span><span class="Token NUMBER">4</span><span class="Token SPACE"> </span><span class="Token NUMBER">389</span><span class="Token LF">
</span><span class="Token NUMBER">5</span><span class="Token SPACE"> </span><span class="Token NUMBER">206</span><span class="Token LF">
</span><span class="Token NUMBER">6</span><span class="Token SPACE"> </span><span class="Token NUMBER">682</span><span class="Token LF">
</span><span class="Token NUMBER">7</span><span class="Token SPACE"> </span><span class="Token NUMBER">327</span></code></pre><h3 id="h3-13">phase_4</h3><pre class="language-txt"><code><span class="Token NUMBER">0x000000000040100c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401010</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0xc</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401015</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">9</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040101a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">14</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x4025cf</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">d</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040101f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">19</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401024</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x400bf0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token UNDERLINE">_</span><span class="Token UNDERLINE">_</span><span class="Token ID">isoc99_sscanf</span><span class="Token AT_SIGN">@</span><span class="Token ID">plt</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401029</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">29</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x2</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040102c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401035</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_4</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040102e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">34</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmpl</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xe</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LE">&lt;=</span><span class="Token NUMBER">14</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401033</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">39</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jbe</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x40103a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_4</span><span class="Token PLUS">+</span><span class="Token NUMBER">46</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401035</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040103a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">46</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xe</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">edx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">14</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040103f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">51</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">esi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401044</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">56</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edi</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">edi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401048</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">60</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x400fce</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">func4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">进入func4</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040104d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">65</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">test</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">返回值应为0</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040104f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">67</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401058</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_4</span><span class="Token PLUS">+</span><span class="Token NUMBER">76</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401051</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">69</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmpl</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token NUMBER">0xc</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401056</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">74</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x40105d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_4</span><span class="Token PLUS">+</span><span class="Token NUMBER">81</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401058</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">76</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040105d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">81</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401061</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">85</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">ret</span></code></pre><p>phase_4的主体就是 <code>func4</code> 这个函数</p><p>这里不难看出是一个递归函数,三个参数,返回值为int,不妨设</p><pre class="language-c"><code><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType INT">int</span><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType SPACE"> </span><span class="Token Identifier DirectDeclaractor FunctionName FunctionName ID">func4</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 LPAREN">(</span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">z</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 RPAREN">)</span><span class="Token DirectDeclaractor Declarator SPACE"> </span><span class="Token CompoundStatement Function BraceDepth-0 LCURLY_BRACE">{</span><span class="Token CompoundStatement Function LF">
</span><span class="Token CompoundStatement Function SPACE">    </span><span class="Token CompoundStatement Function COMMENT">// edi   esi   edx</span><span class="Token CompoundStatement Function LF">
</span><span class="Token CompoundStatement Function BraceDepth-0 RCURLY_BRACE">}</span></code></pre><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000400fce</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fd2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">z</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fd4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">6</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">z</span><span class="Token MINUS">-</span><span class="Token ID">y</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">14</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fd6</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">8</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">14</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fd8</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">10</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">shr</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1f</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token SPACE">           </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token GE">&gt;=</span><span class="Token SPACE"> </span><span class="Token NUMBER">31</span><span class="Token LF">
</span><span class="Token SPACE">                                                         </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token SPACE"> </span><span class="Token ID">if</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token GE">&gt;=</span><span class="Token NUMBER">0</span><span class="Token SPACE"> </span><span class="Token ID">else</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fdb</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">13</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fdd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">15</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">sar</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token HASH">#</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">y</span><span class="Token MINUS">-</span><span class="Token ID">z</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token DIV">/</span><span class="Token NUMBER">2</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fdf</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">17</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token SPACE">   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token ID">temp</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rax</span><span class="Token PLUS">+</span><span class="Token ID">rsi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">y</span><span class="Token MINUS">-</span><span class="Token ID">z</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token DIV">/</span><span class="Token NUMBER">2</span><span class="Token PLUS">+</span><span class="Token ID">z</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">y</span><span class="Token PLUS">+</span><span class="Token ID">z</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token DIV">/</span><span class="Token NUMBER">2</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fe2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">20</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">edi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fe4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">22</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jle</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x400ff2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">func4</span><span class="Token PLUS">+</span><span class="Token NUMBER">36</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">if</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">temp</span><span class="Token MINUS">-</span><span class="Token ID">x</span><span class="Token LE">&lt;=</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fe6</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token MINUS">-</span><span class="Token NUMBER">0x1</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">z</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">temp</span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fe9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x400fce</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">func4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">     </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">递归调用</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400fee</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">return</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token MUL">*</span><span class="Token ID">func4</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">x</span><span class="Token COMMA">,</span><span class="Token ID">y</span><span class="Token COMMA">,</span><span class="Token ID">temp</span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ff0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">34</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401007</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">func4</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ff2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">36</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">递归出口</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ff7</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">edi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ff9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">43</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jge</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401007</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">func4</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">if</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">temp</span><span class="Token GE">&gt;=</span><span class="Token ID">x</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token POINT">-&gt;</span><span class="Token SPACE"> </span><span class="Token ID">这里其实等价于</span><span class="Token SPACE"> </span><span class="Token ID">temp</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ffb</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">45</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x1</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">       </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">esi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">temp</span><span class="Token PLUS">+</span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000400ffe</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">48</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">call</span><span class="Token SPACE">   </span><span class="Token NUMBER">0x400fce</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">func4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">     </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">递归调用</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401003</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">53</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x1</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">return</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token MUL">*</span><span class="Token ID">func4</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">x</span><span class="Token COMMA">,</span><span class="Token ID">temp</span><span class="Token PLUS">+</span><span class="Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token ID">z</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token PLUS">+</span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401007</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040100b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">61</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">ret</span></code></pre><p>所以等价的C语言代码为</p><pre class="language-c"><code><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType INT">int</span><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType SPACE"> </span><span class="Token Identifier DirectDeclaractor FunctionName FunctionName ID">func4</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 LPAREN">(</span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">x</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">y</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">z</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 RPAREN">)</span><span class="Token DirectDeclaractor Declarator SPACE"> </span><span class="Token CompoundStatement Function BraceDepth-0 LCURLY_BRACE">{</span><span class="Token CompoundStatement Function LF">
</span><span class="Token CompoundStatement Function SPACE">  </span><span class="Token Keyword BaseType TypeSpecifier INT">int</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">temp</span><span class="Token Identifier DirectDeclaractor SPACE"> </span><span class="Token InitDeclarator ASSIGN">=</span><span class="Token InitDeclarator SPACE"> </span><span class="Token Identifier PrimaryExpression ID">z</span><span class="Token BinaryOp ConditionalExpression MINUS">-</span><span class="Token Identifier PrimaryExpression ID">y</span><span class="Token Declaration SEMI">;</span><span class="Token Declaration LF">
</span><span class="Token Declaration SPACE">  </span><span class="Token Keyword SelectionStatement IF">if</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token SelectionStatement BraceDepth-1 LPAREN">(</span><span class="Token Identifier PrimaryExpression ID">temp</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression LT">&lt;</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">0</span><span class="Token SelectionStatement BraceDepth-1 RPAREN">)</span><span class="Token SelectionStatement SPACE"> </span><span class="Token Identifier PrimaryExpression ID">temp</span><span class="Token AssignOp AssignmentExpression ADD_ASSIGN">+=</span><span class="Token Constant PrimaryExpression NUMBER">1</span><span class="Token ExpressionStatement SelectionStatement SEMI">;</span><span class="Token ExpressionStatement SelectionStatement LF">
</span><span class="Token ExpressionStatement SelectionStatement SPACE">  </span><span class="Token Identifier PrimaryExpression ID">temp</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token AssignOp AssignmentExpression ASSIGN">=</span><span class="Token AssignOp AssignmentExpression SPACE"> </span><span class="Token Identifier PrimaryExpression ID">temp</span><span class="Token BinaryOp BinaryOp DIV">/</span><span class="Token Constant PrimaryExpression NUMBER">2</span><span class="Token Constant PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression PLUS">+</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Identifier PrimaryExpression ID">y</span><span class="Token ExpressionStatement SEMI">;</span><span class="Token ExpressionStatement SPACE"> </span><span class="Token ExpressionStatement COMMENT">// temp = (y+z)/2</span><span class="Token ExpressionStatement LF">
</span><span class="Token ExpressionStatement SPACE">  </span><span class="Token Keyword SelectionStatement IF">if</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token SelectionStatement BraceDepth-1 LPAREN">(</span><span class="Token Identifier PrimaryExpression ID">temp</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression LE">&lt;=</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Identifier PrimaryExpression ID">x</span><span class="Token SelectionStatement BraceDepth-1 RPAREN">)</span><span class="Token SelectionStatement SPACE"> </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 LCURLY_BRACE">{</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement SelectionStatement SPACE">    </span><span class="Token Keyword SelectionStatement IF">if</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token SelectionStatement BraceDepth-2 LPAREN">(</span><span class="Token Identifier PrimaryExpression ID">temp</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression GE">&gt;=</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Identifier PrimaryExpression ID">x</span><span class="Token SelectionStatement BraceDepth-2 RPAREN">)</span><span class="Token SelectionStatement SPACE"> </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">0</span><span class="Token JumpStatement SelectionStatement SEMI">;</span><span class="Token JumpStatement SelectionStatement SPACE"> </span><span class="Token JumpStatement SelectionStatement COMMENT">// 相当于 temp == x</span><span class="Token JumpStatement SelectionStatement LF">
</span><span class="Token JumpStatement SelectionStatement SPACE">    </span><span class="Token Keyword SelectionStatement ELSE">else</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token CompoundStatement SelectionStatement BraceDepth-2 LCURLY_BRACE">{</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement SelectionStatement SPACE">      </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">2</span><span class="Token BinaryOp BinaryOp MUL">*</span><span class="Token Identifier FunctionName PrimaryExpression ID">func4</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Identifier ID">x</span><span class="Token PPtoken COMMA">,</span><span class="Token Identifier ID">temp</span><span class="Token PPtoken PLUS">+</span><span class="Token PPtoken NUMBER">1</span><span class="Token PPtoken COMMA">,</span><span class="Token Identifier ID">z</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token BinaryOp ConditionalExpression PLUS">+</span><span class="Token Constant PrimaryExpression NUMBER">1</span><span class="Token JumpStatement SEMI">;</span><span class="Token JumpStatement LF">
</span><span class="Token JumpStatement SPACE">    </span><span class="Token CompoundStatement SelectionStatement BraceDepth-2 RCURLY_BRACE">}</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement SelectionStatement SPACE">  </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 RCURLY_BRACE">}</span><span class="Token CompoundStatement SelectionStatement SPACE"> </span><span class="Token Keyword SelectionStatement ELSE">else</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 LCURLY_BRACE">{</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement SelectionStatement SPACE">    </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">2</span><span class="Token BinaryOp ConditionalExpression MUL">*</span><span class="Token Identifier FunctionName PrimaryExpression ID">func4</span><span class="Token BraceDepth-2 LPAREN">(</span><span class="Token Identifier ID">x</span><span class="Token PPtoken COMMA">,</span><span class="Token Identifier ID">y</span><span class="Token PPtoken COMMA">,</span><span class="Token Identifier ID">temp</span><span class="Token PPtoken MINUS">-</span><span class="Token PPtoken NUMBER">1</span><span class="Token BraceDepth-2 RPAREN">)</span><span class="Token JumpStatement SEMI">;</span><span class="Token JumpStatement LF">
</span><span class="Token JumpStatement SPACE">  </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 RCURLY_BRACE">}</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement Function BraceDepth-0 RCURLY_BRACE">}</span></code></pre><p>在 phase_4 中调用的函数是 <code>func4(number[0],0,14)</code>, 函数的返回值应为0</p><p>观察可知递归的出口返回0,所以 number[0] = 7 即可通过 temp==x 这条判断返回. 由phase_4的剩余汇编可知第二个参数 number[1]应为0</p><p>所以本题答案为</p><pre class="language-txt"><code><span class="Token NUMBER">7</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span></code></pre><h3 id="h3-14">phase_5</h3><p>最开始这里使用了 stack canary(栈金丝雀)用来保护栈</p><p>用途是确保 <code>0x18(%rsp)</code> 的数值在函数前后没有发生改动,如果发生改动则执行 <code>&lt;__stack_chk_fail@plt&gt;</code> 调用系统函数 __stack_chk_fail 跳出,从而防止栈溢出</p><p>简单来说就是,防止输入的字符串过长导致栈溢出</p><blockquote><p><a href="https://stackoverflow.com/questions/10325713/why-does-this-memory-address-fs0x28-fs0x28-have-a-random-value" target="_blank">Why does this memory address %fs:0x28 ( fs[0x28] ) have a random value?</a></p><p><a href="https://unix.stackexchange.com/questions/453749/what-sets-fs0x28-stack-canary" target="_blank">What sets fs:[0x28] (stack canary)?</a></p></blockquote><p>接着判断了输入的字符串应该长度为6</p><pre class="language-txt"><code><span class="Token NUMBER">0x000000000040107a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40131b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">string_length</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040107f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">29</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401082</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x4010d2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_5</span><span class="Token PLUS">+</span><span class="Token NUMBER">112</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401084</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">34</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>接着是本次程序的主逻辑判断</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401067</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">5</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token SPACE">                     </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rbx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rdi</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">输入字符串首地址</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010d2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">112</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040108b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">movzbl</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">取出字符</span><span class="Token SPACE"> </span><span class="Token ID">input</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040108f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">45</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">cl</span><span class="Token COMMA">,</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401092</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">48</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401096</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">and</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xf</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">                     </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">只使用低4位</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401099</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">55</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">movzbl</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x4024b0</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">           </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token DOT">.</span></code></pre><p>可以通过gdb查看地址 <code>0x4024b0</code> 的字符串</p><pre class="language-shell"><code><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/s</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x4024b0</span><span class="Token LF">
</span><span class="Token NUMBER">0x4024b0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">array.3449</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">  </span><span class="Token String STRING">&quot;maduiersnfotvbylSo you think you can stop the bomb with ctrl-c, do you?&quot;</span></code></pre><p>由于只有低4位(0-15),所以会被映射到的就是 <code>maduiersnfotvbyl</code></p><p>所以可知这里利用了输入字符串的低4位作为索引,找到这里的一个字符,取出来</p><pre class="language-txt"><code><span class="Token NUMBER">0x00000000004010a0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">62</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">dl</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">         </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">保存到</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token PLUS">+</span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">的位置</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010a4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">66</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010a8</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">70</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010ac</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">74</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x40108b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_5</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">         </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">遍历所有字符</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010ae</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">76</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">movb</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x16</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010b3</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">81</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x40245e</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">                </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">另一个字符串</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010b8</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">86</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">判断字符串相同</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010bd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">91</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x401338</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">strings_not_equal</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010c2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">96</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">test</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004010c4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">98</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x4010d9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_5</span><span class="Token PLUS">+</span><span class="Token NUMBER">119</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>查看另一个字符串</p><pre class="language-shell"><code><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/s</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x40245e</span><span class="Token LF">
</span><span class="Token NUMBER">0x40245e</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token String STRING">&quot;flyers&quot;</span></code></pre><p>所以为了使这两个字符串相同,我们需要做的就是输入一个六位的字符串,将这个字符串的ascii值的低四位作为索引,在 <code>maduiersnfotvbyl</code> 字符串中查找对应的字符,去匹配 <code>flyers</code></p><p>所以索引应该为</p><pre class="language-txt"><code><span class="Token NUMBER">9</span><span class="Token SPACE"> </span><span class="Token NUMBER">15</span><span class="Token SPACE"> </span><span class="Token NUMBER">14</span><span class="Token SPACE"> </span><span class="Token NUMBER">5</span><span class="Token SPACE"> </span><span class="Token NUMBER">6</span><span class="Token SPACE"> </span><span class="Token NUMBER">7</span></code></pre><p>查找字符的ASCII码值有多种方式</p><ul><li><a href="http://c.biancheng.net/c/ascii/" target="_blank">ASCII码对照表</a></li></ul><ul><li>输入 <code>man ascii</code> 打开相关信息查看</li></ul><p>所以本题答案也不唯一,大小写都可以,也有多个映射,这里给出一个答案</p><pre class="language-txt"><code><span class="Token ID">ionefg</span></code></pre><h3 id="h3-15">phase_6</h3><pre class="language-txt"><code><span class="Token NUMBER">0x00000000004010fc</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">8</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x50</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401100</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">12</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r13</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401103</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">15</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401106</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">18</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40145c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">read_six_numbers</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>首先是之前分析过的读取六个整数,保存在 (rsp) 的位置</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401100</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">12</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r13</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">r13</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040110b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">23</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r14</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040110e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">26</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r12d</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">r12d</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401114</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">32</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">r13</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401117</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">35</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x0</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">r13</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">             </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token ID">i</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040111b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">39</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040111e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">42</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x5</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401121</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">45</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jbe</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401128</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">eax</span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token LE">&lt;=</span><span class="Token SPACE"> </span><span class="Token NUMBER">5</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401123</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">47</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401128</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r12d</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">r12d</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040112c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">56</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r12d</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401130</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">60</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x401153</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">95</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">外层循环</span><span class="Token COMMA">,</span><span class="Token ID">判断所有的六个数</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401132</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">62</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">r12d</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ebx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401135</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">65</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">movslq</span><span class="Token SPACE"> </span><span class="Token MOD">%</span><span class="Token ID">ebx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401138</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">68</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040113b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">71</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x0</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040113e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">74</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401145</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">81</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">判断六个数每两个数都不相同</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401140</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">76</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401145</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">81</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ebx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401148</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">84</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x5</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ebx</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040114b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">87</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jle</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401135</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">65</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">内层循环</span><span class="Token COMMA">,</span><span class="Token ID">判断五次</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">最后一个不需要判断</span><span class="Token BraceDepth-0 RPAREN">)</span></code></pre><p>所以这段代码的意思就是判断一下输入的六个数都有应该小于等于6,而且这里使用的是 <code>jbe</code> 无符号判断,所以也<code>eax-1</code>也应该大于等于0,即所有的数大于等于1,并且每两个数都不相同.</p><blockquote><p>从这里我们可以看出这应该是一个1-6的全排列中的一种情况</p></blockquote><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401153</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">95</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x18</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">设置循环终点</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401158</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">100</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">r14</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040115b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">103</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x7</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401160</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">108</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401162</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">110</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">                </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">7</span><span class="Token MINUS">-</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401164</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">112</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token COMMA">,</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401166</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">114</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x4</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040116a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">118</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040116d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">121</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401160</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">108</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>这里的汇编就是将栈内的六个数a都变成7-a</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401197</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">163</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token SPACE">        </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040119a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">166</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040119d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">169</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jle</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401183</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">143</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">如果</span><span class="Token SPACE"> </span><span class="Token ID">number</span><span class="Token BraceDepth-0 LSQUAR_PAREN">[</span><span class="Token ID">rsi</span><span class="Token BraceDepth-0 RSQUAR_PAREN">]</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token COMMA">,</span><span class="Token ID">只有一种情况</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040119f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">171</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011a4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">176</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6032d0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011a9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">181</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401176</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">130</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token DOT">.</span><span class="Token DOT">.</span><span class="Token DOT">.</span></code></pre><p>我们不为1的情况,他会跳转到+130的位置,这里出现了一个地址 <code>0x6032d0</code>,并且将 eax 设为1</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401176</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">130</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040117a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">134</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040117d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">137</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040117f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">139</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401176</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">130</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>接下来做循环, 使用 <code>mov 0x8(%rdx),%rdx</code> 不断地赋值,直到 eax == ecx,这种操作可以看出应该是一个链表的跳转</p><p>我们可以使用 <code>x/a</code> 来查看这个指针指向的位置,注意+8</p><pre class="language-shell"><code><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032d0</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032d0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node1</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">0x10000014c</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032d8</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032d8</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node1+8</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x6032e0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token ID">node2</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032e8</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032e8</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node2+8</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x6032f0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token ID">node3</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032f8</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032f8</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node3+8</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x603300</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token ID">node4</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603308</span><span class="Token LF">
</span><span class="Token NUMBER">0x603308</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node4+8</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x603310</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token ID">node5</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/a</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603318</span><span class="Token LF">
</span><span class="Token NUMBER">0x603318</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node5+8</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x603320</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token ID">node6</span><span class="Token REDIRECT_TO">&gt;</span></code></pre><p>这里可以看出来是六个node,且跳转的次数对应ecx.所以现在的对应关系如下</p><table><tr><th>输入</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr><tr><td style="text-align:center">                rdx的值</td><td style="text-align:center">                ?</td><td style="text-align:center">                0x6032e0</td><td style="text-align:center">                0x6032f0</td><td style="text-align:center">                0x603300</td><td style="text-align:center">                0x603310</td><td style="text-align:center">                0x603320</td></tr></table><p>循环的终点就是将这个指针的值赋给 (rsp+2*rsi+0x20)的位置</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401188</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">148</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x20</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token NUMBER">2</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">这里的</span><span class="Token SPACE"> </span><span class="Token ID">rsi</span><span class="Token SPACE"> </span><span class="Token ID">是输入字符串的索引</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token DIV">/</span><span class="Token NUMBER">4</span><span class="Token DIV">/</span><span class="Token NUMBER">8</span><span class="Token DIV">/</span><span class="Token NUMBER">12</span><span class="Token DIV">/</span><span class="Token NUMBER">16</span><span class="Token DIV">/</span><span class="Token NUMBER">20</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040118d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">153</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x4</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401191</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">157</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x18</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x18</span><span class="Token SPACE"> </span><span class="Token ID">对应的值是24</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token NUMBER">24</span><span class="Token DIV">/</span><span class="Token NUMBER">4</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">6</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token ID">也即是外层循环的终点</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401195</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">161</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x4011ab</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">183</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401197</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">163</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ecx</span><span class="Token SPACE">       </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">否则</span><span class="Token SPACE"> </span><span class="Token ID">ecx</span><span class="Token SPACE"> </span><span class="Token ID">赋值下一个数字</span></code></pre><p>而如果是 ecx == 1 的情况,就是直接将 <code>0x6032d0</code> 赋值给 edx</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401183</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">143</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6032d0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401188</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">148</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x20</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token NUMBER">2</span><span class="Token BraceDepth-0 RPAREN">)</span></code></pre><p>所以现在是</p><table><tr><th>输入</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr><tr><td style="text-align:center">                rdx的值</td><td style="text-align:center">                0x6032d0</td><td style="text-align:center">                0x6032e0</td><td style="text-align:center">                0x6032f0</td><td style="text-align:center">                0x603300</td><td style="text-align:center">                0x603310</td><td style="text-align:center">                0x603320</td></tr><tr><td style="text-align:center">                保存在栈中的位置</td><td style="text-align:center">                (rsp+0x20)</td><td style="text-align:center">                (rsp+0x28)</td><td style="text-align:center">                (rsp+0x30)</td><td style="text-align:center">                (rsp+0x38)</td><td style="text-align:center">                (rsp+0x40)</td><td style="text-align:center">                (rsp+0x48)</td></tr></table><p>最后当外层循环结束之后跳转到 +183 继续执行</p><pre class="language-txt"><code><span class="Token NUMBER">0x00000000004011ab</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">183</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x20</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">栈中第一个地址</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011b0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">188</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x28</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">0x28</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011b5</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">193</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x50</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token SPACE">          </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rsi</span><span class="Token SPACE"> </span><span class="Token ID">是结束的位置</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011ba</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">198</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011bd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">201</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token SPACE">              </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">栈中下一个地址</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011c0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">204</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">           </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">将下一个地址赋给</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">第一个地址</span><span class="Token PLUS">+</span><span class="Token NUMBER">8</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token ID">的内存单元</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011c4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">208</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011c8</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">212</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rsi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011cb</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">215</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x4011d2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">222</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011cd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">217</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011d0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">220</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x4011bd</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">201</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>这段汇编做的事情就是将栈中六个地址串起来,每一个地址+8的内存单元保存着下一个地址</p><p>这里举一个例子,比如我们输入的是 3 1 5 2 4 6,那么先经过一次 7-x 的操作变成了 4 6 2 5 3 1. 然后这个数据保存到ecx中作为从 <code>0x6032d0</code>跳转的次数</p><p>那么按照这个顺序,现在保存到栈中的数据就应该依次是</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20221108181508.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20221108181508.png" alt="20221108181508"></a></p><p>由于之前跳转的时候node123456之间存在着索引,这里就是将原本的索引破坏掉,创建一个一个新的链表,新的一组指针索引</p><blockquote><p>例如原先 <code>0x6032e0</code>(node2) 的下一跳 <code>0x6032e8</code> 的值是 <code>0x6032f0</code>(node3),现在就变成了 <code>0x603310</code>(node5)</p></blockquote><p>接着就是最后的一步了</p><pre class="language-txt"><code><span class="Token NUMBER">0x00000000004011d2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">222</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">movq</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011da</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">230</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x5</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ebp</span><span class="Token SPACE">                </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rbx</span><span class="Token SPACE"> </span><span class="Token ID">在</span><span class="Token PLUS">+</span><span class="Token NUMBER">183</span><span class="Token ID">做了赋值</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rsp</span><span class="Token PLUS">+</span><span class="Token NUMBER">20</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token ID">栈中第一个地址</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011df</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">235</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token SPACE">           </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">下一跳的地址</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011e3</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">239</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">              </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">rax</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011e5</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">241</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">              </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">比较第一个地址内存值和第二个地址的内存值</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011e7</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">243</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jge</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x4011ee</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">250</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">   </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">递减排序</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011e9</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">245</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011ee</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">250</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011f2</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">254</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x1</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">ebp</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004011f5</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">257</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x4011df</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_6</span><span class="Token PLUS">+</span><span class="Token NUMBER">235</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>我们可以使用gdb查看当前节点地址的值</p><pre class="language-shell"><code><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032d0</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032d0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node1</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">332</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032e0</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032e0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node2</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">168</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x6032f0</span><span class="Token LF">
</span><span class="Token NUMBER">0x6032f0</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node3</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">924</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603300</span><span class="Token LF">
</span><span class="Token NUMBER">0x603300</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node4</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">691</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603310</span><span class="Token LF">
</span><span class="Token NUMBER">0x603310</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node5</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">477</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token Program ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token PATH">x/d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603320</span><span class="Token LF">
</span><span class="Token NUMBER">0x603320</span><span class="Token SPACE"> </span><span class="Token REDIRECT_FROM">&lt;</span><span class="Token Program ID">node6</span><span class="Token REDIRECT_TO">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">       </span><span class="Token NUMBER">443</span></code></pre><p>根据值递减关系,对应的索引应该是 0x6032f0 -&gt; 0x603300 -&gt; 0x603310 -&gt; 0x603320 -&gt; 0x6032d0 -&gt; 0x6032e0</p><p>查一下之前的表格可以得到</p><table><tr><th>输入</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th></tr><tr><td style="text-align:center">                rdx的值</td><td style="text-align:center">                0x6032d0</td><td style="text-align:center">                0x6032e0</td><td style="text-align:center">                0x6032f0</td><td style="text-align:center">                0x603300</td><td style="text-align:center">                0x603310</td><td style="text-align:center">                0x603320</td></tr><tr><td style="text-align:center">                保存在栈中的位置</td><td style="text-align:center">                (rsp+0x20)</td><td style="text-align:center">                (rsp+0x28)</td><td style="text-align:center">                (rsp+0x30)</td><td style="text-align:center">                (rsp+0x38)</td><td style="text-align:center">                (rsp+0x40)</td><td style="text-align:center">                (rsp+0x48)</td></tr></table><p>所以对应的输入应该是 3 4 5 6 1 2,因为之前是7-x,所以应该反过来,所以最终的答案就是</p><pre class="language-txt"><code><span class="Token NUMBER">4</span><span class="Token SPACE"> </span><span class="Token NUMBER">3</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token SPACE"> </span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token NUMBER">6</span><span class="Token SPACE"> </span><span class="Token NUMBER">5</span></code></pre><h3 id="h3-16">secret_phase</h3><p>六个关卡都通过了就会提示实验通关,但是bomb实验还有一个隐藏关卡,注意到在 <code>bomb.c</code> 的最后有一行注释</p><pre class="language-c"><code><span class="Token COMMENT">/* Wow, they got it!  But isn&#x27;t something... missing?  Perhaps
 * something they overlooked?  Mua ha ha ha ha! */</span></code></pre><p>这说明其实还有谜题没有解开,我们可以使用 <code>disas main</code> 来查看所有的步骤,并没有发现遗漏,都是 <code>phase_x</code> + <code>phase_defused</code> 的模式,所以问题一定是出现在 <code>phase_defused</code> 之中</p><p>进行反汇编 <code>disas phase_defused</code>之后就可以发现存在一个隐藏关卡</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401630</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">108</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x401242</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">secret_phase</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>所以我们需要阅读这段汇编寻找到如何进入这个函数</p><pre class="language-txt"><code><span class="Token NUMBER">0x00000000004015c4</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x78</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015c8</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">fs</span><span class="Token COLON">:</span><span class="Token NUMBER">0x28</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015d1</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">13</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x68</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015d6</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">18</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">xor</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015d8</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">20</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmpl</span><span class="Token SPACE">   </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6</span><span class="Token COMMA">,</span><span class="Token NUMBER">0x202181</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rip</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE">        </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603760</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">num_input_strings</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015df</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jne</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x40163f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">phase_defused</span><span class="Token PLUS">+</span><span class="Token NUMBER">123</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>这里的 <code>0x603760</code> 应该是一个整数(因为它在和立即数6进行比较),可以根据命名推测大概率是输入的字符串的个数,如果能输入六次字符串并且还运行到这里显然前面的六关都通过了,我们可以稍后使用gdb打断点的方式来验证我们的猜想</p><pre class="language-txt"><code><span class="Token NUMBER">0x00000000004015e1</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">29</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">r8</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015e6</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">34</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0xc</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rcx</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015eb</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">39</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdx</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015f0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">44</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x402619</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">输入格式化</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015f5</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">49</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x603870</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edi</span><span class="Token SPACE">                 </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">输入的字符串</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015fa</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">54</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x400bf0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token UNDERLINE">_</span><span class="Token UNDERLINE">_</span><span class="Token ID">isoc99_sscanf</span><span class="Token AT_SIGN">@</span><span class="Token ID">plt</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x00000000004015ff</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">59</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x3</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">三个结果</span></code></pre><p><code>x/s 0x402619</code> 可以看到<code>sscanf</code>的输入格式化是 &quot;%d %d %s&quot;, 两个整数一个字符串,但是获取的输入地址是 <code>0x603870</code> 这个我们并不知道是哪一个字符串,如果现在使用 <code>x/s</code> 查看只会得到一个空字符串,那么很有可能这里保存着我们输入的字符串,我们可以稍后使用gdb打断点的方式来验证我们的猜想并且确定是哪一关输入的字符串</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401604</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">64</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x402622</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401609</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">69</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040160e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">74</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x401338</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">strings_not_equal</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401613</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">79</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">test</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span></code></pre><p>接着判断了字符串是否相同, <code>x/s 0x402622</code> 查看到最后一个 <code>%s</code> 对应的字符串应该是 &quot;DrEvil&quot;</p><p>我们先在 &lt;+54&gt; 也就是调用 sccanf之前打一个断点 <code>b *0x4015fa</code>,然后使用 <code>r input.txt</code> 进行调试</p><p>bomb提供了一个参数用于从文件中读取内容,所以每一关完成之后我们都可以把答案写在一个文件里(input.txt),然后直接运行它就可以了,从文件中读完所有的内容之后再会切换到STDIN</p><pre class="language-txt"><code><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">d</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603760</span><span class="Token LF">
</span><span class="Token NUMBER">0x603760</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">num_input_strings</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token NUMBER">6</span><span class="Token LF">
</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">gdb</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token DIV">/</span><span class="Token ID">s</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x603870</span><span class="Token LF">
</span><span class="Token NUMBER">0x603870</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">input_strings</span><span class="Token PLUS">+</span><span class="Token NUMBER">240</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">   </span><span class="Token QUOTO">&quot;</span><span class="Token NUMBER">7</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token QUOTO">&quot;</span></code></pre><p>这里也验证了我们之前的猜想,输入六次进入到这里的时候 <code>num_input_strings</code> 是6,并且 <code>0x603870</code> 地址对应的字符串是 <code>7 0</code>这是我们第四关的答案,所以需要在第四关后面追加一个字符串 <code>DrEvil</code> 就可以进入隐藏关卡了</p><p>反汇编 <code>disas secret_phase</code>之后发现这个函数并不复杂</p><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401242</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">push</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401243</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40149e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">read_line</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401248</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">6</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xa</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">              </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">十进制</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040124d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">11</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401252</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">16</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401255</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">19</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x400bd0</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">strtol</span><span class="Token AT_SIGN">@</span><span class="Token ID">plt</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>即将字符串转为10进制的整数(long类型)</p><pre class="language-txt"><code><span class="Token NUMBER">0x000000000040125a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rbx</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040125d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">27</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token MINUS">-</span><span class="Token NUMBER">0x1</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401260</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">30</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x3e8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token SPACE"> </span><span class="Token LE">&lt;=</span><span class="Token SPACE"> </span><span class="Token NUMBER">1000</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401265</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">35</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jbe</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x40126c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">secret_phase</span><span class="Token PLUS">+</span><span class="Token NUMBER">42</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401267</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">37</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040126c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">42</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">ebx</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token SPACE">                    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">esi</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040126e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">44</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x6030f0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edi</span><span class="Token SPACE">               </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">一个地址</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401273</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">49</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x401204</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401278</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">54</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x2</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                    </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">返回值应该为2</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040127b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x401282</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">secret_phase</span><span class="Token PLUS">+</span><span class="Token NUMBER">64</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040127d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">59</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x40143a</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">explode_bomb</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span></code></pre><p>输入的整数应该小于等于 1001, 接着edi是一个地址,esi是输入的整数,调用 <code>fun7</code>,并且返回值应为2</p><p>假设fun7的形参如下</p><pre class="language-c"><code><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType INT">int</span><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType SPACE"> </span><span class="Token Identifier DirectDeclaractor FunctionName FunctionName ID">fun7</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 LPAREN">(</span><span class="Token Keyword BaseType TypeSpecifier LONG">long</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Pointer Declarator POINTER">*</span><span class="Token Identifier DirectDeclaractor ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword BaseType TypeSpecifier LONG">long</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">x</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 RPAREN">)</span><span class="Token DirectDeclaractor Declarator SPACE"> </span><span class="Token CompoundStatement Function BraceDepth-0 LCURLY_BRACE">{</span><span class="Token CompoundStatement Function LF">
</span><span class="Token CompoundStatement Function SPACE">  </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token JumpStatement SEMI">;</span><span class="Token JumpStatement LF">
</span><span class="Token CompoundStatement Function BraceDepth-0 RCURLY_BRACE">}</span></code></pre><pre class="language-txt"><code><span class="Token NUMBER">0x0000000000401204</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">sub</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401208</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">4</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">test</span><span class="Token SPACE">   </span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">如果p</span><span class="Token ASSIGN">=</span><span class="Token ASSIGN">=</span><span class="Token NUMBER">0</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">即空地址</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token ID">返回</span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040120b</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">7</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x401238</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040120d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">9</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">     </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">                </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">edx</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token MUL">*</span><span class="Token ID">p</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040120f</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">11</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">if</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MUL">*</span><span class="Token ID">p</span><span class="Token SPACE"> </span><span class="Token LE">&lt;=</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401211</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">13</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jle</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x401220</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token PLUS">+</span><span class="Token NUMBER">28</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401213</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">15</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x8</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token SPACE">             </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">p</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">p</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x8</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401217</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">19</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x401204</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">再次调用</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040121c</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">24</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">return</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token MUL">*</span><span class="Token ID">fun7</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">p</span><span class="Token PLUS">+</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token ID">x</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040121e</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">26</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x40123d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401220</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">28</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x0</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401225</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">33</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">cmp</span><span class="Token SPACE">    </span><span class="Token MOD">%</span><span class="Token ID">esi</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">edx</span><span class="Token SPACE">                  </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">if</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MUL">*</span><span class="Token ID">p</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">x</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token SPACE"> </span><span class="Token ID">return</span><span class="Token SPACE"> </span><span class="Token NUMBER">0</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401227</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">35</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">je</span><span class="Token SPACE">     </span><span class="Token NUMBER">0x40123d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401229</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">37</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x10</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rdi</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">p</span><span class="Token SPACE"> </span><span class="Token ASSIGN">=</span><span class="Token SPACE"> </span><span class="Token ID">p</span><span class="Token SPACE"> </span><span class="Token PLUS">+</span><span class="Token SPACE"> </span><span class="Token NUMBER">0x10</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040122d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">41</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">callq</span><span class="Token SPACE">  </span><span class="Token NUMBER">0x401204</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token SPACE">            </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">再次调用</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401232</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">46</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">lea</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x1</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rax</span><span class="Token COMMA">,</span><span class="Token NUMBER">1</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">      </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">return</span><span class="Token SPACE"> </span><span class="Token NUMBER">2</span><span class="Token MUL">*</span><span class="Token ID">fun7</span><span class="Token BraceDepth-0 LPAREN">(</span><span class="Token ID">p</span><span class="Token PLUS">+</span><span class="Token NUMBER">0x10</span><span class="Token COMMA">,</span><span class="Token ID">x</span><span class="Token BraceDepth-0 RPAREN">)</span><span class="Token PLUS">+</span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401236</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">50</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">jmp</span><span class="Token SPACE">    </span><span class="Token NUMBER">0x40123d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token ID">fun7</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401238</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">52</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">mov</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0xffffffff</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">eax</span><span class="Token SPACE">           </span><span class="Token HASH">#</span><span class="Token SPACE"> </span><span class="Token ID">return</span><span class="Token SPACE"> </span><span class="Token MINUS">-</span><span class="Token NUMBER">1</span><span class="Token LF">
</span><span class="Token NUMBER">0x000000000040123d</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">57</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">add</span><span class="Token SPACE">    </span><span class="Token DOLLAR">$</span><span class="Token NUMBER">0x8</span><span class="Token COMMA">,</span><span class="Token MOD">%</span><span class="Token ID">rsp</span><span class="Token LF">
</span><span class="Token NUMBER">0x0000000000401241</span><span class="Token SPACE"> </span><span class="Token BraceDepth-0 LANGLE_BRACE">&lt;</span><span class="Token PLUS">+</span><span class="Token NUMBER">61</span><span class="Token BraceDepth-0 RANGLE_BRACE">&gt;</span><span class="Token COLON">:</span><span class="Token SPACE">    </span><span class="Token ID">retq</span></code></pre><p>所以整体的思路还是很清晰的,这应该是一个二叉树的结构,如果大于则+16,如果小于则+8,类似root-&gt;left,root-&gt;right的情况</p><p>那么我们就可以从地址 <code>0x6030f0</code> 出发,左右左右的跳转,完整的画出这棵二叉树</p><p><a data-lightbox="example-1" href="https://raw.githubusercontent.com/learner-lu/picbed/master/20221109185152.png"><img src="https://raw.githubusercontent.com/learner-lu/picbed/master/20221109185152.png" alt="20221109185152"></a></p><p>这段程序对应的C代码如下</p><pre class="language-c"><code><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType INT">int</span><span class="Token Keyword BaseType TypeSpecifier FunctionReturnType SPACE"> </span><span class="Token Identifier DirectDeclaractor FunctionName FunctionName ID">fun7</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 LPAREN">(</span><span class="Token Keyword BaseType TypeSpecifier LONG">long</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Pointer Declarator POINTER">*</span><span class="Token Identifier DirectDeclaractor ID">p</span><span class="Token COMMA">,</span><span class="Token SPACE"> </span><span class="Token Keyword BaseType TypeSpecifier LONG">long</span><span class="Token Keyword BaseType TypeSpecifier SPACE"> </span><span class="Token Identifier DirectDeclaractor ID">x</span><span class="Token DirectDeclaractor Declarator BraceDepth-0 RPAREN">)</span><span class="Token DirectDeclaractor Declarator SPACE"> </span><span class="Token CompoundStatement Function BraceDepth-0 LCURLY_BRACE">{</span><span class="Token CompoundStatement Function LF">
</span><span class="Token CompoundStatement Function SPACE">  </span><span class="Token Keyword SelectionStatement IF">if</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token SelectionStatement BraceDepth-1 LPAREN">(</span><span class="Token Identifier PrimaryExpression ID">p</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression EQ">==</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">0</span><span class="Token SelectionStatement BraceDepth-1 RPAREN">)</span><span class="Token SelectionStatement SPACE"> </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token UnaryOp UnaryExpression MINUS">-</span><span class="Token Constant PrimaryExpression NUMBER">1</span><span class="Token JumpStatement SelectionStatement SEMI">;</span><span class="Token JumpStatement SelectionStatement LF">
</span><span class="Token JumpStatement SelectionStatement SPACE">  </span><span class="Token Keyword SelectionStatement IF">if</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token SelectionStatement BraceDepth-1 LPAREN">(</span><span class="Token UnaryOp UnaryExpression POINTER">*</span><span class="Token Identifier PrimaryExpression ID">p</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression LE">&lt;=</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Identifier PrimaryExpression ID">x</span><span class="Token SelectionStatement BraceDepth-1 RPAREN">)</span><span class="Token SelectionStatement SPACE"> </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 LCURLY_BRACE">{</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement SelectionStatement SPACE">    </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">2</span><span class="Token BinaryOp BinaryOp MUL">*</span><span class="Token Identifier FunctionName PrimaryExpression ID">fun7</span><span class="Token BraceDepth-2 LPAREN">(</span><span class="Token Identifier ID">p</span><span class="Token PPtoken PLUS">+</span><span class="Token PPtoken NUMBER">16</span><span class="Token PPtoken COMMA">,</span><span class="Token Identifier ID">x</span><span class="Token BraceDepth-2 RPAREN">)</span><span class="Token BinaryOp ConditionalExpression PLUS">+</span><span class="Token Constant PrimaryExpression NUMBER">1</span><span class="Token JumpStatement SEMI">;</span><span class="Token JumpStatement SPACE"> </span><span class="Token JumpStatement COMMENT">// 向右</span><span class="Token JumpStatement LF">
</span><span class="Token JumpStatement SPACE">  </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 RCURLY_BRACE">}</span><span class="Token CompoundStatement SelectionStatement SPACE"> </span><span class="Token Keyword SelectionStatement ELSE">else</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 LCURLY_BRACE">{</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement SelectionStatement SPACE">    </span><span class="Token Keyword SelectionStatement IF">if</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token SelectionStatement BraceDepth-2 LPAREN">(</span><span class="Token UnaryOp UnaryExpression POINTER">*</span><span class="Token Identifier PrimaryExpression ID">p</span><span class="Token Identifier PrimaryExpression SPACE"> </span><span class="Token BinaryOp ConditionalExpression EQ">==</span><span class="Token BinaryOp ConditionalExpression SPACE"> </span><span class="Token Identifier PrimaryExpression ID">x</span><span class="Token SelectionStatement BraceDepth-2 RPAREN">)</span><span class="Token SelectionStatement SPACE"> </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">0</span><span class="Token JumpStatement SelectionStatement SEMI">;</span><span class="Token JumpStatement SelectionStatement LF">
</span><span class="Token JumpStatement SelectionStatement SPACE">    </span><span class="Token Keyword SelectionStatement ELSE">else</span><span class="Token Keyword SelectionStatement SPACE"> </span><span class="Token Keyword JumpStatement RETURN">return</span><span class="Token Keyword JumpStatement SPACE"> </span><span class="Token Constant PrimaryExpression NUMBER">2</span><span class="Token BinaryOp ConditionalExpression MUL">*</span><span class="Token Identifier FunctionName PrimaryExpression ID">fun7</span><span class="Token BraceDepth-2 LPAREN">(</span><span class="Token Identifier ID">p</span><span class="Token PPtoken PLUS">+</span><span class="Token PPtoken NUMBER">8</span><span class="Token PPtoken COMMA">,</span><span class="Token Identifier ID">x</span><span class="Token BraceDepth-2 RPAREN">)</span><span class="Token JumpStatement SelectionStatement SEMI">;</span><span class="Token JumpStatement SelectionStatement SPACE"> </span><span class="Token JumpStatement SelectionStatement COMMENT">// 向左</span><span class="Token JumpStatement SelectionStatement LF">
</span><span class="Token JumpStatement SelectionStatement SPACE">  </span><span class="Token CompoundStatement SelectionStatement BraceDepth-1 RCURLY_BRACE">}</span><span class="Token CompoundStatement SelectionStatement LF">
</span><span class="Token CompoundStatement Function BraceDepth-0 RCURLY_BRACE">}</span></code></pre><p>预期结果是2那么根据if分支的选项满足这个输出的结果应该是 2<i>(2</i>(0)+1), 对应 <code>左-右</code>(22); 和 2<i>(2</i>(2*(0))+1), 对应 <code>左-右-左</code>(20)</p><p>所以本题答案有两个</p><pre class="language-txt"><code><span class="Token NUMBER">22</span><span class="Token LF">
</span><span class="Token NUMBER">20</span></code></pre><p>关于 @plt</p><ul><li><a href="https://stackoverflow.com/questions/25667205/what-exactly-does-putsplt-mean" target="_blank">回答1</a></li></ul><ul><li><a href="https://stackoverflow.com/questions/5469274/what-does-plt-mean-here" target="_blank">回答2</a></li></ul></div>
    <div class="dir-tree"><ul><li><a href="../../md-docs/README" >README</a></li></ul><ul><li><a href="../../快速开始/安装与使用" >快速开始</a><ul><li><a href="../../快速开始/安装与使用" >安装与使用</a></li></ul><ul><li><a href="../../快速开始/配置信息" >配置信息</a></li></ul><ul><li><a href="../../快速开始/功能演示" >功能演示</a></li></ul><ul><li><a href="../../快速开始/代码高亮" >代码高亮</a></li></ul></li></ul><ul><li><a href="../../API/zood init" >API</a><ul><li><a href="../../API/zood init" >zood init</a></li></ul><ul><li><a href="../../API/zood config" >zood config</a></li></ul><ul><li><a href="../../API/zood -g" >zood -g</a></li></ul></li></ul><ul><li><a href="../../a/1" >a</a><ul><li><a href="../../a/1" >1</a></li></ul><ul><li><a href="../../a/2" >2</a></li></ul><ul><li><a href="../../a/3" >3</a></li></ul><ul><li><a href="../../a/4" >4</a></li></ul><ul><li><a href="../../a/5" >5</a></li></ul><ul><li><a href="../../a/6" >6</a></li></ul><ul><li><a href="../../a/7" >7</a></li></ul><ul><li><a href="../../a/1111111111111111111" >1111111111111111111</a></li></ul><ul><li><a href="../../a/8" >8</a></li></ul></li></ul></div>
    <div class="zood"><a class="" href="https://github.com/luzhixing12345/zood" target="_blank">zood</a></div>
    <script type="text/javascript" src="../../../js/next_front.js"></script><script>addLink("../../a/5","../../a/7","ab");</script><script type="text/javascript" src="../../../js/change_mode.js"></script><script>addChangeModeButton("../../../img/sun.png","../../../img/moon.png");</script><script type="text/javascript" src="../../../js/copy_code.js"></script><script>addCodeCopy("../../../img/before_copy.png","../../../img/after_copy.png");</script><script type="text/javascript" src="../../../js/navigator.js"></script><script type="text/javascript" src="../../../js/picture_preview.js"></script><script type="text/javascript" src="../../../js/global_js_configuration.js"></script>
</body>

</html>