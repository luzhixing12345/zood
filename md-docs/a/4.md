
# 123789

设计实现一个Linux内核模块,此模块完成如下功能

- [ ] 将新创建的文件系统的操作接口和VFS对接.
- [ ] 实现新的文件系统的超级块、dentry、inode的读写操作.
- [ ] 实现新的文件系统的权限属性,不同的用户不同的操作属性.
- [ ] 实现和用户态程序的对接,用户程序
- [ ] 设计实现一个用户态应用程序,可以将一个块设备(可以用文件模拟)格式化成自己设计的文件系统的格式.
- [x] 设计一个用户态的测试用例应用程序,测试验证自己的文件系统的open/read/write/ls/cd 等通常文件系统的访问.

哈伦裤撒旦金克拉的急啊离开卡

- 设计实现一个用户态应用程
- 设计实现一个用户态应用程
- 3

爱上了打卡时间绿卡的撒记录

1. 1231
2. 123
3. sd

爱上建档立卡手机打开拉萨的加拉

- 首先我们注意到 spt 记录的是 gva 的映射, 也就是说 vmm 需要**为每个guest VM中的每个进程的gPT都维护一个对应的sPT**, 且不论多虚拟机, 为每一个进程都记录一份 spt 这显然大大增加了内存的开销.
- 其次每个进程的页表是不断变化的, 分配/释放内存时都会修改页表, 那么此时 spt 也要跟着同步. qemu 的做法是
  1. 首先 qemu 会将gPT本身使用的物理页面设为**write protected**
  2. 每当gPT有变动的时候(比如添加或删除了一个页表项),就会产生被VMM截获的**page fault异常**
  3. 重新计算GVA->HPA的映射,更改sPT中对应的页表项

1. **抛弃"知识树",拥抱"混沌系统"**
   内核不是教科书里工整的知识框架,而是数千万行代码构建的有机生命体.与其试图"系统学习",不如:  
   - **以问题为锚点**:从一次OOM Killer的随机杀戮,到进程调度器引发的"卡顿之谜",让真实的问题牵引你深入子系统.  
   - **与代码对话**:在`fork()`的深渊里看虚拟内存如何裂变,在`ext4`的元数据中追踪文件消失的真相.代码从不说谎,但你需要用`gdb`打断点逼它开口.
   - **警惕"权威解释"**:当教科书说"进程是资源分配单位"时,去`task_struct`里寻找那37个嵌套结构体_真实的定义永远在代码中.  

2. **在硅基与碳基的夹缝中修行**  
   内核是硬件与软件的炼金术产物,你需要:  
   - **触摸机器的灵魂**:在NUMA架构下感受内存访问的时延差异,在CPU流水线中目睹分支预测失败的代价.用`perf stat`量化时钟周期的流逝.  
   - **制造可控的崩溃**:故意写一个耗尽slab内存的内核模块,观察`kmalloc()`如何优雅地崩溃.这些精心设计的灾难,比任何理论都更懂资源管理.  
   - **保持"物理直觉"**:当你在RCU锁的迷宫中徘徊时,想象电子在CPU引脚间穿梭的物理路径,这或许比死读文档更快找到出口.  

3. **在永恒迭代中寻找圣杯**  
   内核世界没有终极答案,只有持续进化的生存博弈:  
   - **与版本号赛跑**:当你在5.x内核中熟稔的API突然在6.x中被`deprecated`,这不是背叛,而是生态进化的必然.学会用`git blame`追踪代码变迁的达尔文轨迹.  
   - **在漏洞中见天地**:分析一个use-after-free漏洞的修复补丁,你看到的不仅是内存安全的教条,更是维护者对复杂度的宣战.  
   - **拥抱"不完美"的艺术**:在`drivers/`目录下,你会看到芯片厂商提交的潦草代码_那是商业现实与理想主义的血腥妥协.  

4. **成为内核生态的共生体**  
   不要做孤独的朝圣者,要成为生态链中的一环:  
   - **从"偷窥"开始**:潜伏在LKML邮件列表,看维护者如何用一句"This doesn't scale"枪毙一个幼稚的patch,那是比算法更重要的设计哲学.  
   - **制造你的痕迹**:哪怕只是给文档补上一个错别字,也要让`Signed-off-by`成为你在内核纪年碑上的铭文.  
   - **培养"维护者思维"**:当你想优化某个子系统时,先问自己:这个改动五年后会给其他开发者埋下多少技术债?  
 
三十年前,Linus在赫尔辛基的公寓里写下第一行内核代码时,他面对的不是神圣的蓝图,而是一团亟待驯服的电子混沌.今天的你也一样:  
- 忘记"征服内核"的妄念,学会在`BUG_ON()`的惊雷中舞蹈  
- 把每次`systemtap`的探测当作与内核的密语  
- 让`dmesg`里滚动的日志成为你的意识流日记  

当某天你发现:  
- 能对着`schedule()`的代码会心一笑  
- 在梦中也看到红黑树在旋转平衡  
- 开始用"我们"指代内核社区  

那一刻,你已不再是学习者, 而是成了活着的Linux编年史.  

(记住:内核不会崩溃,它只是遇到了未定义的哲学困境.)

爱神的箭来到拉萨

1. 123
   1. 123
   
2. 1231
   - 123

- 123
  - 123

- aksl;d
  1. 213
  2. 213


## 写在前面

本系列基础内容是基于 [linux6.6.0](https://mirrors.edge.kernel.org/pub/linux/kernel/v6.x/linux-6.6.tar.gz) 源码进行阅读和分析的, 对于后续内核版本新加入的内容会标明对应的内核版本

本系列包含 **泛操作系统概念** 以及 **linux实现细节**